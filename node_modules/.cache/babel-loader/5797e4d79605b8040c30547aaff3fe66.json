{"ast":null,"code":"var _jsxFileName = \"/home/caionnc/Documents/CC_UFPB/TCC/vlibras-mobile-cross-platform/src/pages/Historic/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { NativeStorage } from '@ionic-native/native-storage';\nimport { IonChip, IonContent, IonText } from '@ionic/react';\nimport { useSelector } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { v4 as uuidv4 } from 'uuid';\nimport paths from 'constants/paths';\nimport { PlayerKeys } from 'constants/player';\nimport PlayerService from 'services/unity';\nimport dateFormat from 'utils/dateFormat';\nimport { logoTranslator1, logoTranslator2 } from '../../assets';\nimport { VideoOutputModal } from '../../components';\nimport { env } from '../../environment/env';\nimport { MenuLayout } from '../../layouts';\nimport { Strings } from './strings';\nimport { useTranslation } from 'hooks/Translation';\nimport './styles.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Historic() {\n  _s();\n\n  const translationsHistoric = useSelector(({\n    video\n  }) => video.translationsHistoric);\n  const [showModal, setShowModal] = useState(false);\n  const [results, setResults] = useState([]);\n  const [log, setLog] = useState([]);\n  const history = useHistory();\n  const location = useLocation();\n  const [historyStorage, setHistoryStorage] = useState({});\n  const [keysToShow, setKeysToShow] = useState(env.videoTranslator ? ['text', 'video'] : ['text']);\n  const [activeKey, setActiveKey] = useState(env.videoTranslator ? 0 : 2);\n  const style = {\n    color: '#1447a6',\n    background: '#d6e5f9',\n    fontWeight: 'bold'\n  };\n  const {\n    setTextPtBr\n  } = useTranslation();\n  const playerService = PlayerService.getService();\n  const promiseHistory = NativeStorage.getItem('history').then(data => {\n    return data;\n  }, error => {\n    setLog(error);\n    return {};\n  });\n\n  const openModalOutput = actualItem => {\n    setShowModal(true);\n    setResults(actualItem);\n  };\n\n  const loadHistory = async () => {\n    setHistoryStorage(await promiseHistory);\n  };\n\n  useEffect(() => {\n    if (location.pathname === paths.HISTORY) loadHistory();\n  }, [location]);\n\n  const formatArrayDate = () => {\n    const arrayState = JSON.parse(JSON.stringify(historyStorage));\n    const dates = Object.keys(arrayState);\n    const formattedObjDate = {};\n    dates.forEach(element => {\n      const formattedDate = dateFormat(element);\n\n      if (formattedObjDate[formattedDate]) {\n        if (formattedObjDate[formattedDate].video) {\n          formattedObjDate[formattedDate].video.push(...arrayState[element].video);\n        }\n\n        if (formattedObjDate[formattedDate].text) {\n          formattedObjDate[formattedDate].text.push(...arrayState[element].text);\n        }\n      } else {\n        formattedObjDate[formattedDate] = {\n          text: arrayState[element].text || [],\n          video: arrayState[element].video || []\n        };\n      }\n    });\n    return formattedObjDate;\n  };\n\n  async function onTranslationHistory(text) {\n    const formatted = text.trim();\n    const gloss = await setTextPtBr(formatted, false);\n    history.replace(paths.HOME);\n    playerService.send(PlayerKeys.PLAYER_MANAGER, PlayerKeys.PLAY_NOW, gloss);\n  }\n\n  const renderAllItems = () => {\n    const formattedHistoric = formatArrayDate();\n    const datesMapped = Object.keys(formattedHistoric).reverse();\n    let doesntHaveKey;\n    return datesMapped.map(column => {\n      doesntHaveKey = 0;\n      return keysToShow.map((key, keyOfKeys) => {\n        if (formattedHistoric[column][key].length != 0) {\n          return formattedHistoric[column][key].map((item, elementKey) => {\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [elementKey === 0 && (keyOfKeys === 0 || doesntHaveKey === 1) && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"date-desc\",\n                children: [\" \", column, \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 23\n              }, this), key === 'video' ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [elementKey === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"historic-container-ion-img-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: logoTranslator2,\n                    className: \"historic-container-ion-img-translator-2\",\n                    alt: \"\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 138,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(IonText, {\n                    children: Strings.TRANSLATOR_TEXT_2\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 143,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 137,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"list-outputs\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"container-outputs\",\n                    onClick: () => openModalOutput(item),\n                    type: \"button\",\n                    children: item.map((value, keyWord) => /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: value\n                    }, uuidv4(), false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 153,\n                      columnNumber: 29\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 147,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [elementKey === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"historic-container-ion-img-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: logoTranslator1,\n                    className: \"historic-container-ion-img-translator-1\",\n                    alt: \"\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 162,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(IonText, {\n                    children: Strings.TRANSLATOR_TEXT_1\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 167,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 161,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"historic-container-box-ion-text\",\n                  onClick: () => onTranslationHistory(item),\n                  tabIndex: 0,\n                  role: \"menu\",\n                  \"aria-hidden\": \"true\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"historic-container-box-ion-text-area\",\n                    children: item\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 177,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 170,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 17\n            }, this);\n          });\n        }\n\n        doesntHaveKey = 1;\n        return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n      });\n    });\n  };\n\n  const setScreenKey = param => {\n    setActiveKey(param);\n\n    switch (param) {\n      case 0:\n        setKeysToShow(['text', 'video']);\n        break;\n\n      case 1:\n        setKeysToShow(['text']);\n        break;\n\n      case 2:\n        setKeysToShow(['video']);\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(MenuLayout, {\n    title: Strings.TOOLBAR_TITLE,\n    mode: \"back\",\n    children: /*#__PURE__*/_jsxDEV(IonContent, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"historic-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"historic-container-ion-chips\",\n          children: [env.videoTranslator && /*#__PURE__*/_jsxDEV(IonChip, {\n            class: \"historic-container-ion-chip\",\n            onClick: () => setScreenKey(0),\n            style: activeKey === 0 ? style : {},\n            children: Strings.CHIP_TEXT_1\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 15\n          }, this), env.videoTranslator && /*#__PURE__*/_jsxDEV(IonChip, {\n            class: \"historic-container-ion-chip\",\n            onClick: () => setScreenKey(1),\n            style: activeKey === 1 ? style : {},\n            children: Strings.CHIP_TEXT_2\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 15\n          }, this), env.videoTranslator && /*#__PURE__*/_jsxDEV(IonChip, {\n            class: \"historic-container-ion-chip\",\n            onClick: () => setScreenKey(2),\n            style: activeKey === 2 ? style : {},\n            children: Strings.CHIP_TEXT_3\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container-render-historic\",\n          children: renderAllItems()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(VideoOutputModal, {\n          outputs: results,\n          showButtons: false,\n          showModal: showModal,\n          setShowModal: setShowModal,\n          playerIntermedium: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 212,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Historic, \"0ic7tBjOMLLos5l4/YS1mbJ4asU=\", false, function () {\n  return [useSelector, useHistory, useLocation, useTranslation];\n});\n\n_c = Historic;\nexport default Historic;\n\nvar _c;\n\n$RefreshReg$(_c, \"Historic\");","map":{"version":3,"sources":["/home/caionnc/Documents/CC_UFPB/TCC/vlibras-mobile-cross-platform/src/pages/Historic/index.tsx"],"names":["React","useEffect","useState","NativeStorage","IonChip","IonContent","IonText","useSelector","useHistory","useLocation","v4","uuidv4","paths","PlayerKeys","PlayerService","dateFormat","logoTranslator1","logoTranslator2","VideoOutputModal","env","MenuLayout","Strings","useTranslation","Historic","translationsHistoric","video","showModal","setShowModal","results","setResults","log","setLog","history","location","historyStorage","setHistoryStorage","keysToShow","setKeysToShow","videoTranslator","activeKey","setActiveKey","style","color","background","fontWeight","setTextPtBr","playerService","getService","promiseHistory","getItem","then","data","error","openModalOutput","actualItem","loadHistory","pathname","HISTORY","formatArrayDate","arrayState","JSON","parse","stringify","dates","Object","keys","formattedObjDate","forEach","element","formattedDate","push","text","onTranslationHistory","formatted","trim","gloss","replace","HOME","send","PLAYER_MANAGER","PLAY_NOW","renderAllItems","formattedHistoric","datesMapped","reverse","doesntHaveKey","map","column","key","keyOfKeys","length","item","elementKey","TRANSLATOR_TEXT_2","value","keyWord","TRANSLATOR_TEXT_1","setScreenKey","param","TOOLBAR_TITLE","CHIP_TEXT_1","CHIP_TEXT_2","CHIP_TEXT_3"],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\n\nimport { NativeStorage } from '@ionic-native/native-storage';\nimport {\n  IonChip,\n  IonContent,\n  IonItem,\n  IonText,\n  IonTextarea,\n} from '@ionic/react';\nimport { useSelector } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport paths from 'constants/paths';\nimport { PlayerKeys } from 'constants/player';\nimport PlayerService from 'services/unity';\nimport { RootState } from 'store';\nimport dateFormat from 'utils/dateFormat';\n\nimport { logoTranslator1, logoTranslator2 } from '../../assets';\nimport { VideoOutputModal } from '../../components';\nimport { env } from '../../environment/env';\nimport { MenuLayout } from '../../layouts';\nimport { Strings } from './strings';\nimport { useTranslation } from 'hooks/Translation';\n\nimport './styles.css';\n\ntype GenericObject = { [key: string]: any };\n\nfunction Historic() {\n  const translationsHistoric = useSelector(\n    ({ video }: RootState) => video.translationsHistoric,\n  );\n\n  const [showModal, setShowModal] = useState(false);\n  const [results, setResults] = useState([]);\n  const [log, setLog] = useState([]);\n  const history = useHistory();\n  const location = useLocation();\n\n  const [historyStorage, setHistoryStorage] = useState<GenericObject>({});\n\n  const [keysToShow, setKeysToShow] = useState(\n    env.videoTranslator ? ['text', 'video'] : ['text'],\n  );\n  const [activeKey, setActiveKey] = useState(env.videoTranslator ? 0 : 2);\n\n  const style = { color: '#1447a6', background: '#d6e5f9', fontWeight: 'bold' };\n\n  const { setTextPtBr } = useTranslation();\n  const playerService = PlayerService.getService();\n\n  const promiseHistory = NativeStorage.getItem('history').then(\n    data => {\n      return data;\n    },\n    error => {\n      setLog(error);\n      return {};\n    },\n  );\n\n  const openModalOutput = (actualItem: any) => {\n    setShowModal(true);\n    setResults(actualItem);\n  };\n\n  const loadHistory = async () => {\n    setHistoryStorage(await promiseHistory);\n  };\n\n  useEffect(() => {\n    if (location.pathname === paths.HISTORY) loadHistory();\n  }, [location]);\n\n  const formatArrayDate = () => {\n    const arrayState = JSON.parse(JSON.stringify(historyStorage));\n    const dates = Object.keys(arrayState);\n    const formattedObjDate: any = {};\n\n    dates.forEach(element => {\n      const formattedDate = dateFormat(element);\n      if (formattedObjDate[formattedDate]) {\n        if (formattedObjDate[formattedDate].video) {\n          formattedObjDate[formattedDate].video.push(\n            ...arrayState[element].video,\n          );\n        }\n        if (formattedObjDate[formattedDate].text) {\n          formattedObjDate[formattedDate].text.push(\n            ...arrayState[element].text,\n          );\n        }\n      } else {\n        formattedObjDate[formattedDate] = {\n          text: arrayState[element].text || [],\n          video: arrayState[element].video || [],\n        };\n      }\n    });\n\n    return formattedObjDate;\n  };\n\n\n\n  async function onTranslationHistory(text: string) {\n    const formatted = text.trim();\n    const gloss = await setTextPtBr(formatted, false);\n\n    history.replace(paths.HOME);\n    playerService.send(PlayerKeys.PLAYER_MANAGER, PlayerKeys.PLAY_NOW, gloss);\n  }\n\n  const renderAllItems = () => {\n    const formattedHistoric = formatArrayDate();\n    const datesMapped = Object.keys(formattedHistoric).reverse();\n    let doesntHaveKey: number;\n\n    return datesMapped.map(column => {\n      doesntHaveKey = 0;\n      return keysToShow.map((key, keyOfKeys) => {\n        if (formattedHistoric[column][key].length != 0) {\n          return formattedHistoric[column][key].map(\n            (item: any, elementKey: any) => {\n              return (\n                <div>\n                  {elementKey === 0 &&\n                    (keyOfKeys === 0 || doesntHaveKey === 1) && (\n                      <p className=\"date-desc\"> {column} </p>\n                    )}\n                  {key === 'video' ? (\n                    <>\n                      {elementKey === 0 && (\n                        <div className=\"historic-container-ion-img-2\">\n                          <img\n                            src={logoTranslator2}\n                            className=\"historic-container-ion-img-translator-2\"\n                            alt=\"\"\n                          />\n                          <IonText>{Strings.TRANSLATOR_TEXT_2}</IonText>\n                        </div>\n                      )}\n                      <div className=\"list-outputs\">\n                        <button\n                          className=\"container-outputs\"\n                          onClick={() => openModalOutput(item)}\n                          type=\"button\"\n                        >\n                          {item.map((value: string, keyWord: string) => (\n                            <span key={uuidv4()}>{value}</span>\n                          ))}\n                        </button>\n                      </div>\n                    </>\n                  ) : (\n                    <>\n                      {elementKey === 0 && (\n                        <div className=\"historic-container-ion-img-1\">\n                          <img\n                            src={logoTranslator1}\n                            className=\"historic-container-ion-img-translator-1\"\n                            alt=\"\"\n                          />\n                          <IonText>{Strings.TRANSLATOR_TEXT_1}</IonText>\n                        </div>\n                      )}\n                      <div\n                        className=\"historic-container-box-ion-text\"\n                        onClick={() => onTranslationHistory(item)}\n                        tabIndex={0}\n                        role=\"menu\"\n                        aria-hidden=\"true\"\n                      >\n                        <p className=\"historic-container-box-ion-text-area\">\n                          {item}\n                        </p>\n                      </div>\n                    </>\n                  )}\n                </div>\n              );\n            },\n          );\n        }\n        doesntHaveKey = 1;\n        return <></>;\n      });\n    });\n  };\n\n  const setScreenKey = (param: number) => {\n    setActiveKey(param);\n    switch (param) {\n      case 0:\n        setKeysToShow(['text', 'video']);\n        break;\n      case 1:\n        setKeysToShow(['text']);\n        break;\n      case 2:\n        setKeysToShow(['video']);\n        break;\n      default:\n        break;\n    }\n  };\n\n  return (\n    <MenuLayout title={Strings.TOOLBAR_TITLE} mode=\"back\">\n      <IonContent>\n        <div className=\"historic-container\">\n          <div className=\"historic-container-ion-chips\">\n            {env.videoTranslator && (\n              <IonChip\n                class=\"historic-container-ion-chip\"\n                onClick={() => setScreenKey(0)}\n                style={activeKey === 0 ? style : {}}\n              >\n                {Strings.CHIP_TEXT_1}\n              </IonChip>\n            )}\n            {env.videoTranslator && (\n              <IonChip\n                class=\"historic-container-ion-chip\"\n                onClick={() => setScreenKey(1)}\n                style={activeKey === 1 ? style : {}}\n              >\n                {Strings.CHIP_TEXT_2}\n              </IonChip>\n            )}\n            {env.videoTranslator && (\n              <IonChip\n                class=\"historic-container-ion-chip\"\n                onClick={() => setScreenKey(2)}\n                style={activeKey === 2 ? style : {}}\n              >\n                {Strings.CHIP_TEXT_3}\n              </IonChip>\n            )}\n          </div>\n          <div className=\"container-render-historic\">{renderAllItems()}</div>\n          <VideoOutputModal\n            outputs={results}\n            showButtons={false}\n            showModal={showModal}\n            setShowModal={setShowModal}\n            playerIntermedium\n          />\n        </div>\n      </IonContent>\n    </MenuLayout>\n  );\n}\n\nexport default Historic;\n"]},"metadata":{},"sourceType":"module"}